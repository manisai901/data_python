import json

# Simulated GENERATORS dictionary
GENERATORS = {
    'id': 'random_string',
    'first_name': 'fake.first_name',
    'last_name': 'fake.last_name',
    'full_name': 'full_name',
    'company': 'fake.company',
    'industry': 'industry',
    'business_department': 'department',
    'company_desc': 'fake.catch_phrase',
    'company_number_employees': 'number_employee',
    'city': 'fake.city',
    'country': 'fake.country',
    'sex': 'sex',
    'ean': 'fake.ean',
    'url': 'fake.url',
    'email': 'fake.email',
    'business_email': 'fake.company_email',
    'website': 'fake.url'
}

# Generate BigQuery schema (assume all are STRING + NULLABLE)
bq_schema = [
    {
        "name": key,
        "type": "STRING",
        "mode": "NULLABLE"
    }
    for key in GENERATORS.keys()
]

# Save schema to a file
with open("bq_schema.json", "w") as f:
    json.dump(bq_schema, f, indent=2)

print("âœ… BigQuery schema saved to bq_schema.json")
